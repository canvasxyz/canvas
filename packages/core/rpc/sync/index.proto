syntax = "proto3";

message Node {
  uint32 level = 1;
  bytes key = 2;
  bytes hash = 3;
  optional bytes value = 4;
}

message MessageRequest {
  enum MessageType {
    CANVAS_SESSION = 0;
    CANVAS_ACTION = 1;
  }

  MessageType type = 1;
  bytes id = 2;
}

message Request {
  message GetRootRequest {}

  message GetChildrenRequest {
    uint32 level = 2;
    bytes key = 3;
  }

  message GetMessagesRequest {
    repeated MessageRequest messages = 2;
  }

  uint32 seq = 1;
  oneof request {
    GetRootRequest get_root = 2;
    GetChildrenRequest get_children = 3;
    GetMessagesRequest get_messages = 4;
  }
}

message Response {
  message GetRootResponse {
    uint32 level = 2;
    bytes hash = 3;
  }

  message GetChildrenResponse {
    repeated Node nodes = 2;
  }

  message GetMessagesResponse {
    repeated bytes messages = 2;
  }

  uint32 seq = 1;
  oneof response {
    GetRootResponse get_root = 2;
    GetChildrenResponse get_children = 3;
    GetMessagesResponse get_messages = 4;
  }
}